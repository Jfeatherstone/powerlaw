<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Warnings" href="warnings.html" /><link rel="prev" title="Generating data" href="generating_data.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Advanced Topics - powerlaw 1.6.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/overrides.css?v=e9ec496f" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">powerlaw 1.6.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">powerlaw 1.6.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../tutorials_top.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="other_libraries.html">Differences with other libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading_data.html">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="scaling_range.html">Identifying the scaling range</a></li>
<li class="toctree-l2"><a class="reference internal" href="discrete_continuous.html">Continuous and discrete data</a></li>
<li class="toctree-l2"><a class="reference internal" href="ranges_and_constraints.html">Parameter Ranges and Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="comparing_distributions.html">Comparing distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="generating_data.html">Generating data</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Advanced Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="warnings.html">Warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_distributions.html">Adding New Distributions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fit.html"><code class="docutils literal notranslate"><span class="pre">Fit</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributions.html"><code class="docutils literal notranslate"><span class="pre">Distribution</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributions.html#powerlaw.Power_Law"><code class="docutils literal notranslate"><span class="pre">Power_Law</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributions.html#powerlaw.Truncated_Power_Law"><code class="docutils literal notranslate"><span class="pre">Truncated_Power_Law</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributions.html#powerlaw.Exponential"><code class="docutils literal notranslate"><span class="pre">Exponential</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributions.html#powerlaw.Stretched_Exponential"><code class="docutils literal notranslate"><span class="pre">Stretched_Exponential</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributions.html#powerlaw.Lognormal"><code class="docutils literal notranslate"><span class="pre">Lognormal</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../distributions.html#powerlaw.Lognormal_Positive"><code class="docutils literal notranslate"><span class="pre">Lognormal_Positive</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/advanced_topics.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="advanced-topics">
<h1>Advanced Topics<a class="headerlink" href="#advanced-topics" title="Link to this heading">¶</a></h1>
<p>This page covers many eclectic topics that don’t fit elsewhere, and generally
are only relevant for advanced users.</p>
<section id="no-possible-fits">
<h2>No possible fits<a class="headerlink" href="#no-possible-fits" title="Link to this heading">¶</a></h2>
<p>When fitting a distribution to data, there may be no valid fits. This would
most typically arise from overly strict fitting requirements, but it could
also happen because the data truly doesn’t fit the specified form. This
latter case is easy enough to test (just look at the PDF of the data), but
the former case can be a little harder to fix.</p>
<p>First, in order to diagnose this issue, you should look at the <code class="docutils literal notranslate"><span class="pre">noise_flag</span></code>
property of either the <code class="docutils literal notranslate"><span class="pre">Fit</span></code> object (signifying that every value of <code class="docutils literal notranslate"><span class="pre">xmin</span></code>
failed) or for a specific distribution object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">load_test_dataset</span><span class="p">(</span><span class="s1">&#39;blackouts&#39;</span><span class="p">)</span>

<span class="c1"># pl.noiseflag will be True since the powerlaw exponent of the</span>
<span class="c1"># blackouts dataset should be around 2.4, outside of the prescribed</span>
<span class="c1"># range.</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Power_Law</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parameter_ranges</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">pl</span><span class="o">.</span><span class="n">noise_flag</span>

<span class="c1"># fit.noiseflag will be True since the prescribed sigma_threshold</span>
<span class="c1"># is too low</span>
<span class="c1"># range.</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma_threshold</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">noise_flag</span>
</pre></div>
</div>
<p>One way to fix this is by adjusting your parameter ranges, threshold, constraints,
etc. If you worry that the fitting landscape is too noisy, you can try
providing an explicit initial condition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">initial_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">2.4</span><span class="p">})</span>
</pre></div>
</div>
<p>If you’re seeing a warning message about something, fixing that may help
to get better fitting results; see the tutorial about <a class="reference external" href="warnings.html">dealing with warnings</a> for more information.</p>
</section>
<section id="multiple-possible-fits">
<h2>Multiple possible fits<a class="headerlink" href="#multiple-possible-fits" title="Link to this heading">¶</a></h2>
<p>Changes in <span class="math notranslate nohighlight">\(x_{min}\)</span> with different parameter requirements illustrate
that there may be more than one fit to consider. Assuming there is no
<span class="math notranslate nohighlight">\(x_{max}\)</span>, the optimal <span class="math notranslate nohighlight">\(x_{min}\)</span> is selected by finding the
<span class="math notranslate nohighlight">\(x_{min}\)</span> value with the lowest distance (see <code class="docutils literal notranslate"><span class="pre">xmin_distance</span></code> keyword
for <a class="reference internal" href="../fit.html#powerlaw.Fit" title="powerlaw.Fit"><code class="xref py py-class docutils literal notranslate"><span class="pre">powerlaw.Fit</span></code></a>) between the data and the fit for that <span class="math notranslate nohighlight">\(x_{min}\)</span>
value. If there is only one local minimum across all <span class="math notranslate nohighlight">\(x_{min}\)</span> values,
this is philosophically simple.</p>
<p>If, however, there are multiple local minima in this distance metric across
<span class="math notranslate nohighlight">\(x_{min}\)</span> with similar minimum values, it may be worth noting and
considering these alternative fits. For this purpose, <a class="reference internal" href="../fit.html#powerlaw.Fit" title="powerlaw.Fit"><code class="xref py py-class docutils literal notranslate"><span class="pre">powerlaw.Fit</span></code></a>
retains information on all the possible <span class="math notranslate nohighlight">\(x_{min}\)</span>, along with the
parameters of the subsequent fit, in the <code class="docutils literal notranslate"><span class="pre">xmin_fitting_results</span></code> property.</p>
<p>As an example, let’s examine the fitting results for the <code class="docutils literal notranslate"><span class="pre">blackouts</span></code> data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">load_test_dataset</span><span class="p">(</span><span class="s1">&#39;blackouts&#39;</span><span class="p">)</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">data</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span>

<span class="c1"># Now examine the xmin fitting results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">xmin_fitting_results</span><span class="p">[</span><span class="s2">&quot;xmin&quot;</span><span class="p">],</span> <span class="n">fit</span><span class="o">.</span><span class="n">xmin_fitting_results</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">])</span>
</pre></div>
</div>
<figure class="align-default" id="id1">
<img alt="../_images/blackouts_multiple_fits.png" src="../_images/blackouts_multiple_fits.png" />
<figcaption>
<p><span class="caption-text">The Kolmogorov-Smirnov distance and <span class="math notranslate nohighlight">\(\alpha\)</span> values for the resulting fit for every possible
value of <span class="math notranslate nohighlight">\(x_{min}\)</span> for the <code class="docutils literal notranslate"><span class="pre">blackouts</span></code> data set.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The first minima is at <span class="math notranslate nohighlight">\(x_{min} = 50\)</span>, and has a distance value of .1
and an <span class="math notranslate nohighlight">\(\alpha\)</span> value of 1.78. The second, more optimal, fit is at
<span class="math notranslate nohighlight">\(x_{min} = 230\)</span>, with a distance of .06 and <span class="math notranslate nohighlight">\(\alpha = 2.27\)</span>.
The reality of which of these is a better fit to the data will depend
on exactly what type of data you have, and isn’t always obvious if there
are fits with similar distance values, as above.
For example, if you expect that the power law exponent should be restricted
to a specific range, say greater than 2, the second minima would be the
most correct choice. If you have expectations about such values, it is
a good idea to try and encode this in the parameter ranges or constraints
of fitting.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">load_test_dataset</span><span class="p">(</span><span class="s1">&#39;blackouts&#39;</span><span class="p">)</span>

<span class="n">fit</span> <span class="o">=</span> <span class="n">powerlaw</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">data</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">parameter_ranges</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>

<span class="o">...</span>
</pre></div>
</div>
<figure class="align-default" id="id2">
<img alt="../_images/blackouts_multiple_fits_bounded.png" src="../_images/blackouts_multiple_fits_bounded.png" />
<figcaption>
<p><span class="caption-text">The Kolmogorov-Smirnov distance and <span class="math notranslate nohighlight">\(\alpha\)</span> values for the resulting fit for every possible
value of <span class="math notranslate nohighlight">\(x_{min}\)</span> for the <code class="docutils literal notranslate"><span class="pre">blackouts</span></code> data set while constraining
<span class="math notranslate nohighlight">\(\alpha\)</span> to be in the range <span class="math notranslate nohighlight">\([2, 3]\)</span>.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>For more information, see the tutorial about <a class="reference external" href="ranges_and_constraints.html">restricting fits with ranges and
constraints</a>.</p>
</section>
<section id="maximum-likelihood-and-independence-assumptions">
<h2>Maximum likelihood and independence assumptions<a class="headerlink" href="#maximum-likelihood-and-independence-assumptions" title="Link to this heading">¶</a></h2>
<p>A fundamental assumption of the maximum likelihood method used for fitting,
as well as the loglikelihood ratio test for comparing the goodness of fit of
different distributions, is that individual data points are independent [1].
In some datasets, correlations between observations may be known or expected.
For example, in a geographic dataset of the elevations of peaks, of the
observation of a mountain of height <span class="math notranslate nohighlight">\(X\)</span> could be correlated with the
observation of foothills nearby of height <span class="math notranslate nohighlight">\(X/10\)</span>. Large correlations
can potentially greatly alter the quality of the maximum likelihood fit.
Theoretically, such correlations may  be incorporated into the likelihood
calculations, but doing so would greatly increase the computational
requirements for fitting.</p>
<p>Depending on the nature of the correlation, some datasets can be “decorrelated”
by selectively omitting portions of the data [2]. Using the foothills
example, the correlated foothills may be known to occurr within 10km of a
mountain, and beyond 10km the correlations drops to 0. Requiring a minimum
distance of 10km between observations of peaks, and omitting any additional
observations within that distance, would decorrelate the dataset.</p>
<p>An alternative to maximum likelihood estimation is minimum distance estimation,
which fits the theoretical distribution to the data by minimizing the
Kolmogorov-Smirnov (or some other) distance between the data and the fit.
This can be specified by passing <code class="docutils literal notranslate"><span class="pre">fit_method='ks'</span></code> to the <code class="docutils literal notranslate"><span class="pre">Fit</span></code>; the
particular distance, whether Kolmogorov-Smirnov, Anderson-Darling, etc. is
controlled with the <code class="docutils literal notranslate"><span class="pre">xmin_distance</span></code> keyword. However, the use of this
option will not solve the problem of correlated data points for the
loglikelihood ratio tests used in <a class="reference internal" href="../fit.html#powerlaw.Fit.distribution_compare" title="powerlaw.Fit.distribution_compare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">powerlaw.Fit.distribution_compare()</span></code></a>.</p>
</section>
<section id="numerical-fitting-arguments">
<h2>Numerical fitting arguments<a class="headerlink" href="#numerical-fitting-arguments" title="Link to this heading">¶</a></h2>
<p>When numerical fitting is necessary (see tutorials on <a class="reference external" href="other_libraries.html">other libraries</a>
or <a class="reference external" href="discrete_continuous.html">continuous and discrete</a>), this library
uses <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>. This function is incredibly deep and
decisions about parameter values could be discussed ad nauseam; we give a
brief overview of how this function is used here, but see the source code
— particularly the <a class="reference internal" href="../distributions.html#powerlaw.Distribution.fit" title="powerlaw.Distribution.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">powerlaw.Distribution.fit()</span></code></a> function — for
more information.</p>
<p>As of v1.6.0, there are two options for fitting method used: Nelder-Mead
when there are no constraints, and COBYLA when there are constraints.
Both of these have been roughly tested across a range of distributions
(though primarily power laws) and they seem to work well enough. Otherwise,
there is no particular reason why these optimization methods are used.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<p>[1] Clauset, A., Shalizi, C. R., &amp; Newman, M. E. J. (2009). Power-law
distributions in empirical data. SIAM Review, 51(4), 661–703.
<a class="reference external" href="https://doi.org/10.1137/070710111">https://doi.org/10.1137/070710111</a></p>
<p>[2] Klaus, A., Yu, S., &amp; Plenz, D. (2011). Statistical Analyses Support
Power Law Distributions Found in Neuronal Avalanches. PLOS ONE, 6(5),
e19779. <a class="reference external" href="https://doi.org/10.1371/journal.pone.0019779">https://doi.org/10.1371/journal.pone.0019779</a></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="warnings.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Warnings</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="generating_data.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Generating data</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Jeff Alstott
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Advanced Topics</a><ul>
<li><a class="reference internal" href="#no-possible-fits">No possible fits</a></li>
<li><a class="reference internal" href="#multiple-possible-fits">Multiple possible fits</a></li>
<li><a class="reference internal" href="#maximum-likelihood-and-independence-assumptions">Maximum likelihood and independence assumptions</a></li>
<li><a class="reference internal" href="#numerical-fitting-arguments">Numerical fitting arguments</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=72d88caf"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>